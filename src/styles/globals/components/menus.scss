@use "partials";
@use "./typography" as typography;

.floating-content {
  > .menu {
    max-height: inherit !important;
  }
}

@mixin menu-content-wrapper() {
  display: flex;
  flex-direction: column;
  overflow-y: hidden;
  flex-grow: 100;
  position: relative;
  min-height: 100px;
  @content;

  > .menu__content {
    max-height: 100%;
    height: 100%;
  }
}

.menu {
  display: flex;
  flex-direction: column;
  gap: theme("spacing.1");
  overflow: hidden;
  max-height: 100%;

  > .menu__header {
    display: flex;
    flex-direction: column;
    gap: theme("spacing.1");
    padding: theme("spacing.2");
  }

  > .menu__content {
    overflow-y: auto;
    flex-grow: 100;
  }

  // The wrapping component is used to reserve space for the menu content so that loading indicators
  // or errors can be shown in the interim, before the content is either dynamically loaded or the
  // data is populated.;
  > .menu__content-wrapper {
    @include menu-content-wrapper() {
      > .menu__content {
        overflow-y: auto;
      }
    }
  }
}

.menu__item-group {
  display: flex;
  flex-direction: column;

  > .menu__item-group__label {
    padding: 10px 10px;
  }

  > .menu__content-wrapper {
    @include menu-content-wrapper();
  }
}

@mixin bordered-menu-item() {
  > .menu__item {
    &:not(:last-of-type) {
      border-bottom: 1px solid theme("colors.border");
    }
  }
}

.menu__content {
  display: flex;
  flex-direction: column;
  overflow-x: hidden;
  position: relative;

  &--bordered {
    @include bordered-menu-item();
    > a {
      @include bordered-menu-item();
    }
  }

  // Note: Sometimes a menu__item element is wrapped in an anchor tag if it represents a link.
  .menu__item {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 6px 10px;
    gap: 10px;
    color: theme("colors.body");
    transition-property: background-color, background, border-color, color, fill, stroke, opacity,
      box-shadow, transform;
    transition-duration: 100ms;

    // The line height may be overridden in the component if the height is specified as a prop.
    @include typography.font($type: "body", $size: "xs", $line-height: 28px);

    @include partials.disabled {
      color: theme("colors.disabled");
    }

    &.menu__item--locked,
    &.menu__item--loading {
      pointer-events: none;
    }

    @include partials.hovered {
      &:not(.menu__item--selected, .disabled, .menu__item--locked) {
        background-color: theme("colors.gray.50");
        color: theme("colors.body-hover");
      }
    }

    @include partials.focused {
      &:not(.menu__item--selected, .disabled, .menu__item--locked) {
        background-color: theme("colors.gray.50");
      }
    }

    &.menu__item--selected:not(.disabled) {
      background-color: theme("colors.blue.50");
      @include partials.hovered {
        &:not(.disabled, .menu__item--locked) {
          background-color: theme("colors.blue.100");
        }
      }
      @include partials.focused {
        &:not(.disabled, .menu__item--locked) {
          background-color: theme("colors.blue.100");
        }
      }
    }

    > .menu__item__content {
      height: 100%;
      text-align: left;
      line-height: inherit;
      flex-grow: 100;
      color: inherit;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
      @include typography.truncate();
    }
  }
}
